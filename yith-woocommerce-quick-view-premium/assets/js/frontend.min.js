/**
 * frontend.min.js
 *
 * @author Your Inspiration Themes
 * @package YITH WooCommerce Quick View
 * @version 1.0.0
 */
jQuery(document).ready(function(s){"use strict";var t="",r="yith-inline"!=yith_qv.type?s(document).find(".yith-quick-view"):s(document).find(".yith-quick-view").clone(),c=r.find(".yith-quick-view-content"),i=r.find(".yith-quick-view-close"),_=r.find(".yith-quick-view-nav"),n=[],d=null,h=null,e=function(){if("yith-inline"!=yith_qv.type){var t=s(document).find(".yith-quick-view .yith-wcqv-wrapper"),i=s(window).width(),e=s(window).height(),a=i-60>yith_qv.popup_size_width?yith_qv.popup_size_width:i-60,n=e-120>yith_qv.popup_size_height?yith_qv.popup_size_height:e-120;t.css({left:i/2-a/2,top:e/2-n/2,width:a+"px",height:n+"px"})}};if("undefined"!=typeof yith_qv){s.fn.yith_wcqv_init=function(){t=s(document).find(".yith-wcqv-button"),s.each(t,function(){var t=s(this).data("product_id");-1==s.inArray(t,n)&&n.push(t)}),_.length&&l(_),m(i),e(),t.off("click"),imagesLoaded(c,function(){a(t)}),s(document).on("click",".yith-wcqv-button",function(t){var i=s(this),e=(i.data("type"),i.data("product_id"));if(e){if(t.preventDefault(),t.stopPropagation(),yith_qv.enable_loading||o(i),"yith-inline"==yith_qv.type){var a=i.parents(yith_qv.main_product),n=a.hasClass("last")?a:a.nextUntil(".first",".last");if(n.hasClass("last")||(n=s(yith_qv.main_product).last()),a.closest(".yith-quick-view").length||n.next(".yith-quick-view").length)o(c);else{if(r.hasClass("open"))return r.removeClass("open").removeClass("loading"),void r.slideUp("slow",function(){n.after(r),f(i,e)});n.after(r)}}else s(document).trigger("qv_loading");f(i,e)}})};var a=function(t){t.length&&!t.hasClass("inside-thumb")||s.each(t,function(){var t=s(this),i=t.closest(yith_qv.main_product).find(yith_qv.main_image_class);t.css({top:(i.height()-t.height())/2+"px",right:(i.width()-t.width())/2+"px",display:"inline-block"})})},o=function(t){void 0!==yith_qv.loader&&(t.block({message:null,overlayCSS:{background:"#fff url("+yith_qv.loader+") no-repeat center",opacity:.5,cursor:"none"}}),s(document).on("qv_loader_stop",function(){t.unblock()}))},l=function(t){var i=t.find("> a");i.off("click"),i.on("click",function(t){t.preventDefault();var i=s(this),e=i.data("product_id");o(c),f(i,e)})},f=function(t,i){var e=s.inArray(i,n),a={action:"yith_load_product_quick_view",product_id:i,prev_product_id:n[e-1],next_product_id:n[e+1],context:"frontend",lang:yith_qv.lang};null!=h&&h.abort(),h=s.ajax({url:yith_qv.ajaxurl.toString().replace("%%endpoint%%","yith_load_product_quick_view"),data:a,dataType:"json",type:"GET",success:function(t){c.html(t.html),"slider"==t.images_type?imagesLoaded(c,function(){u()}):v(),480<s(window).width()&&c.find("div.summary").perfectScrollbar({suppressScrollX:!0}),(yith_qv.is2_2||yith_qv.increment_plugin)&&c.find("div.quantity:not(.buttons_added), td.quantity:not(.buttons_added)").addClass("buttons_added").append('<input type="button" value="+" class="plus" />').prepend('<input type="button" value="-" class="minus" />');var i=c.find(".variations_form");i.each(function(){s(this).wc_variation_form(),void 0!==s.fn.yith_wccl?s(this).yith_wccl():void 0!==s.yith_wccl&&t.prod_attr&&s.yith_wccl(t.prod_attr)}),i.trigger("check_variations"),i.trigger("reset_image"),void 0!==s.fn.yith_ywraq_variations&&(s.fn.yith_ywraq_variations(),c.find('[name|="variation_id"]').trigger("change"));var e=c.find(".yith-wocc-wrapper");e.length&&void 0!==s.fn.yith_wocc_init&&e.yith_wocc_init(),void 0!==s.fn.prettyPhoto&&c.find("a[data-rel^='prettyPhoto']").prettyPhoto({hook:"data-rel",social_tools:!1,theme:"pp_woocommerce",horizontal_padding:20,opacity:.8,deeplinking:!1,show_title:!1}),yith_qv.ajaxcart&&g(t.product_link,c);var a=i.find(".single_variation_wrap");if(p(a),void 0!==s.fn.ajaxForm&&void 0!==s.fn.wpcf7InitForm&&(s.fn.ajaxForm({delegation:!0,target:"#output"}),c.find("div.wpcf7 > form").wpcf7InitForm()),_.length){var n=_.find(".yith-wcqv-next"),o=_.find(".yith-wcqv-prev");t.prev_product?(o.find("div").html(t.prev_product_preview),o.data("product_id",t.prev_product).css({display:"block"})):o.css({display:"none"}),t.next_product?(n.find("div").html(t.next_product_preview),n.data("product_id",t.next_product).css({display:"block"})):n.css({display:"none"})}r.hasClass("open")||(r.removeClass("loading").addClass("open"),"yith-inline"==yith_qv.type?r.slideDown("slow"):s("html").addClass("yith-quick-view-is-open")),h=null,s(document).trigger("qv_loader_stop")}})},u=function(){var t=c.find(".yith-quick-view-images-slider");t.length&&void 0!==s.fn.bxSlider&&(d=t.bxSlider({pager:!1,prevText:"",nextText:""}))},v=function(){s(".yith-quick-view-single-thumb").on("click",function(){s(this).siblings().removeClass("active");var t=s(this).parents(".images"),i=t.find(".woocommerce-main-image"),e=t.find("img.wp-post-image"),a=s(this).data("img"),n=s(this).data("href");e.length||(i=(e=t.find("img.attachment-quick_view_image_size")).closest("a")),e.attr("src",a).attr("srcset",a).attr("src-orig",a),i.attr("href",n),s(this).addClass("active"),s(document).trigger("yith_wcqv_change_thumb")})},m=function(t){t.off("click"),t.on("click",function(t){t.preventDefault(),i()}),"yith-inline"!=yith_qv.type&&(s(document).keyup(function(t){27===t.keyCode&&i()}),s(".yith-quick-view-overlay").on("click",function(t){r.hasClass("loading")||i()}));var i=function(){r.removeClass("open").removeClass("loading"),"yith-inline"!=yith_qv.type?(s("html").removeClass("yith-quick-view-is-open"),setTimeout(function(){e()},1e3)):r.slideUp("slow",function(){e()})},e=function(){c.html(""),s(document).trigger("qv_is_closed")}};s(document).on("yith_infs_adding_elem yith-wcan-ajax-filtered",function(){s.fn.yith_wcqv_init()});var g=function(r,c){c.find("form.cart").on("submit",function(t){var i,e=s(this),o=e.find("button");if(!("is_one_click"==e.find('input[name="_yith_wocc_one_click"]').val())){t.preventDefault();var a=new FormData;s.each(e.find("input[type='file']"),function(t,e){s.each(s(e)[0].files,function(t,i){a.append(e.name,i)})});var n=!1;i=e.serializeArray(),s.each(i,function(t,i){"add-to-cart"==i.name&&(n=!0),a.append(i.name,i.value)}),a.append("wp_http_referer",r),n||a.append("add-to-cart",o.val()),void 0!==yith_qv.loader&&o.block({message:null,overlayCSS:{background:"#fff url("+yith_qv.loader+") no-repeat center",opacity:.5,cursor:"none"}}),s.ajax({url:r,data:a,contentType:!1,processData:!1,type:"POST",dataType:"html",success:function(t){if(yith_qv.redirect_checkout)window.location.href=yith_qv.checkout_url;else{var i=s(t).find("div.woocommerce-message, ul.woocommerce-error"),e=s(t).find("#header .yit_cart_widget"),a=c.find("div.summary");if(i.length||(i=s(t).filter("div.woocommerce-message, ul.woocommerce-error")),s("#header").find(".yit_cart_widget").replaceWith(e),"undefined"!=typeof wc_cart_fragments_params){var n;try{n="sessionStorage"in window&&null!==window.sessionStorage,window.sessionStorage.setItem("wc","test"),window.sessionStorage.removeItem("wc")}catch(t){n=!1}s.ajax({url:wc_cart_fragments_params.wc_ajax_url.toString().replace("%%endpoint%%","get_refreshed_fragments"),type:"POST",success:function(t){t&&t.fragments&&(s.each(t.fragments,function(t,i){s(t).replaceWith(i)}),n&&(sessionStorage.setItem(wc_cart_fragments_params.fragment_name,JSON.stringify(t.fragments)),sessionStorage.setItem("wc_cart_hash",t.cart_hash)),s(document.body).trigger("wc_fragments_refreshed"))}})}a.find(".woocommerce-message, .woocommerce-error").remove(),a.prepend(i),void 0!==yith_qv.loader&&o.unblock(),a.scrollTop(0),s("body").trigger("added_to_cart")}}})}})},p=function(t){var n=s(".yith-quick-view-thumbs"),o=s("div.images .attachment-quick_view_image_size").first(),r=s("div.images a.woocommerce-main-image"),c=[];s(".yith-quick-view-images-slider").find(".yith-quick-view-slide").each(function(t,i){c[t]=s(this).data("attachment_id")+""}),t.on("show_variation",function(t,i){if(void 0!==i.attachment_id){var e=n.find('.yith-quick-view-single-thumb[data-attachment_id="'+i.attachment_id+'"]'),a=s.inArray(i.attachment_id,c);e.length?e.click():-1!==a&&null!==d?d.goToSlide(a):i.image&&i.image.src&&1<i.image.src.length&&(o.wc_set_variation_attr("src",i.image.src),o.wc_set_variation_attr("height",i.image.src_h),o.wc_set_variation_attr("width",i.image.src_w),o.wc_set_variation_attr("srcset",i.image.srcset),o.wc_set_variation_attr("sizes",i.image.sizes),o.wc_set_variation_attr("title",i.image.title),o.wc_set_variation_attr("alt",i.image.alt),o.wc_set_variation_attr("data-src",i.image.full_src),o.wc_set_variation_attr("data-large_image",i.image.full_src),o.wc_set_variation_attr("data-large_image_width",i.image.full_src_w),o.wc_set_variation_attr("data-large_image_height",i.image.full_src_h),r.wc_set_variation_attr("href",i.image.full_src),n.find(".yith-quick-view-single-thumb").removeClass("active"))}}),t.on("hide_variation",function(){o.wc_reset_variation_attr("src"),o.wc_reset_variation_attr("width"),o.wc_reset_variation_attr("height"),o.wc_reset_variation_attr("srcset"),o.wc_reset_variation_attr("sizes"),o.wc_reset_variation_attr("title"),o.wc_reset_variation_attr("alt"),o.wc_reset_variation_attr("data-src"),o.wc_reset_variation_attr("data-large_image"),o.wc_reset_variation_attr("data-large_image_width"),o.wc_reset_variation_attr("data-large_image_height"),r.wc_reset_variation_attr("href"),n.find(".yith-quick-view-single-thumb").first().click(),null!==d&&d.goToSlide(0)})};s(document).on("qv_loading",function(){if(!yith_qv.enable_loading)return!1;var t=s(document).find(".yith-quick-view"),i=t.find(".yith-quick-view-overlay");if(t.hasClass("loading")||t.addClass("loading"),!i.find("p").length){var e=s("<p />").text(yith_qv.loading_text);i.append(e)}}),yith_qv.enable_zoom&&void 0!==s.fn.yith_magnifier&&s(document).on("qv_loader_stop",function(t){if("undefined"==typeof yith_magnifier_options)return!1;var a=s(".yith-quick-view-content .images"),n=a.find(".yith_magnifier_zoom"),o=a.find(".yith_magnifier_zoom img.attachment-quick_view_image_size"),i=a.find(".yith_magnifier_zoom").attr("href"),e=a.find(".yith_magnifier_zoom img").attr("src");a.data("yith_magnifier")&&a.yith_magnifier("destroy"),n.attr("href",i),o.attr("src",e),o.attr("srcset",e),o.attr("src-orig",e);var r={enableSlider:!1,position:"inside",elements:{zoom:n,zoomImage:o}};r=s.extend(!0,{},yith_magnifier_options,r),a.find("a.pp_expand, a.yith_expand").remove(),a.yith_magnifier(r),s(document).off("yith_wcqv_change_thumb").on("yith_wcqv_change_thumb",function(){a.data("yith_magnifier")&&a.yith_magnifier("destroy"),a.yith_magnifier(r)}),s(document).on("found_variation","form.variations_form",function(t,i){var e=!1;if(i.image_src&&i.image_src.length?e=i.image_src:i.image.src&&(e=i.image.src),!e)return!1;n.attr("href",e),o.attr("src",e),o.attr("srcset",e),o.attr("src-orig",e),a.data("yith_magnifier")&&a.yith_magnifier("destroy"),a.yith_magnifier(r)}).on("reset_image",function(t){n.attr("href",i),o.attr("src",e),o.attr("srcset",e),o.attr("src-orig",e),a.data("yith_magnifier")&&a.yith_magnifier("destroy"),a.yith_magnifier(r)})}),s(document).on("qv_loader_stop",function(){"yith-inline"==yith_qv.type&&s("html, body").animate({scrollTop:s(".yith-quick-view").offset().top-100},1e3)}),s.fn.YitdoubleTapToGo=function(){return this.each(function(){var i=!1,e=s(this).closest(".product");s(document).on("qv_loader_stop",function(){e.removeClass("hover_mobile")}),s(this).on("touchstart",function(t){e.siblings().removeClass("hover_mobile"),i&&e.hasClass("hover_mobile")||(t.preventDefault(),e.addClass("hover_mobile"),i=!0)})}),this},yith_qv.ismobile&&s(yith_qv.main_product_link).YitdoubleTapToGo(),s.fn.yith_wcqv_init(),s(document).on("yith_wcqv_wcajaxnav_update post-load",s.fn.yith_wcqv_init),s(window).on("resize",function(){e(),a(s(document).find(".yith-wcqv-button"))}),s(document).on("qv_loader_stop",function(){void 0!==s.fn.tawcvs_variation_swatches_form&&(s(".variations_form").tawcvs_variation_swatches_form(),s(document.body).trigger("tawcvs_initialized"))})}});